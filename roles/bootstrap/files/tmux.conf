# reload tmux conf with "R"
bind "R" source-file -F ~/.tmux.conf

set -g editor "/usr/local/bin/nvim"

# 2^20 lines of scrollback. simple test seems to indicate this requires about 500MB of memory
set -g history-limit 1048576

set -g mode-keys "vi"

# disable escape sequence windows; they seem to crash the server anyways (at least, in the command prompt)
set -g escape-time 0

# enable automatic window renaming
set -g automatic-rename on

# neovim's :checkhealth made me do it
set -sa terminal-overrides ',xterm-256color:RGB'

# support 256 colors
set -g default-terminal "screen-256color"

# set window formats (i.e. text) and styles
set -g window-status-format "#I:(#{b:pane_current_path}) #{pane_current_command} #{p1:window_flags}"
set -g window-status-current-format "#I:(#{b:pane_current_path}) #{pane_current_command} #{p1:window_flags}"
set -g window-status-style "bg=brightblack"
set -g window-status-current-style "fg=black,bg=white,bold"

# add "tmux" just so it's not cryptic
set -g status-left "[tmux #{session_name}] #{?window_bigger,[#{window_offset_x}#,#{window_offset_y}] ,}(#(date '+%%H:%%M %%Z')) #(date -u '+%%H:%%M %%Z %%Y-%%m-%%d') "

# remove status-right
set -g status-right ""

# increase maximum length (from 10) so it doesn't cut off the above
set -g status-left-length 50

# start numbering windows at 1
set -g base-index 1

# renumber the windows when one is closed
set -g renumber-windows on

# use double pane border lines, since "single" looks too similar to vim splits
set -g pane-border-lines double

set -g status-style "bg=default"
set -g status-right-style "dim"
set -g status-left-style "dim"
set -g status-justify left

bind -T copy-mode-vi v send-keys -X begin-selection
bind -T copy-mode-vi V send-keys -X select-line
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel
bind -T copy-mode-vi C-q send-keys -X rectangle-toggle

bind -T prefix "h" select-pane -L
bind -T prefix "j" select-pane -D
bind -T prefix "k" select-pane -U
bind -T prefix "l" select-pane -R
bind -T prefix "-" last-window
bind -T prefix "%" split-window -h -c "#{pane_current_path}"
bind -T prefix '"' split-window -c "#{pane_current_path}"
bind -T prefix "M" select-layout main-horizontal
